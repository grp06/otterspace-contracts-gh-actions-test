on:
  pull_request:
    types:
      - closed

jobs:
  if_merged:
    if: github.event.pull_request.merged == true
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2
      - run: |
          # Get the latest tag
          latest_tag=$(git describe --tags --abbrev=0)
          # Compare the current version of src/Badges.sol with the version at the latest tag
          if ! git diff $latest_tag -- src/Badges.sol; then
            echo "DIFFERENT"
          fi
      - run: |
          version=$(grep '"version":' package.json | cut -d'"' -f4)
          git tag $version
          git push origin $version
